(()=>{var e={857:(e,t)=>{"use strict";var a;Object.defineProperty(t,"__esModule",{value:!0}),t.LANGUAGE_TO_LOCALE_MAPPING=t.LanguageCode=void 0,(a=t.LanguageCode||(t.LanguageCode={})).DEFAULT="en",a.EN="en",a.ES="es",a.PT="pt",a.JP="jp",a.TW="tw",a.FR="fr",a.DE="de",a.IT="it",t.LANGUAGE_TO_LOCALE_MAPPING={en:"en",es:"es",pt:"pt",jp:"ja",tw:"zh_TW",fr:"fr",de:"de",it:"it"}},21:(e,t,a)=>{const{LanguageCode:n}=a(857),r=Object.freeze({"aws.amazon.com":o,"aws.com":o,"www.aws.com":o});function o(){const e=window.location.pathname.split("/");if(e.length<2)return null;const t=e[1];return 2===t.length?t.toLowerCase():null}e.exports={getExperimentalFeatures:function(){const e=localStorage.getItem("cb-experimentalFeatures");return e&&"string"==typeof e?JSON.parse(e):[]},getLanguageCodeFromPage:function(){const e=window.location.hostname;let t;const a=r[e];return t=a?a():function(e){let t=e?.split("/")?.find((e=>e.match("^[a-z]{2}$")))?.toLowerCase();return t??n.EN}(e+window.location.pathname),Object.values(n).includes(t)?t:n.EN},LanguageCode:n,isNetworkError:function(e){return"Failed to fetch"===e.message||"Load failed"===e.message||"The operation was aborted. "===e.message},isExpectedError:function(e){return"Unexpected end of JSON input"===e.message||"returnfalse is not defined"===e.message||e.message.includes("Cannot destructure property")||e.message.includes("Unexpected token")||e.message.includes("Unexpected end of JSON input")||e.message.includes("r.data is undefined")}}},330:(e,t,a)=>{const{getExperimentalFeatures:n,getLanguageCodeFromPage:r,isNetworkError:o,isExpectedError:s}=a(21),{LANGUAGE_TO_LOCALE_MAPPING:i,LanguageCode:c}=a(857),g=["alpha","beta","gamma","prod"],u="CHAT_LOADER_",l=`${u}AVAILABILITY`,d=`${u}COMPATIBILITY_ISSUE_COUNT`,m=`${u}TOAST_MESSAGE_CONFIG_FAILURE_COUNT`,p=`${u}NETWORK_FAILURE_COUNT`,f=`${u}EXPECTED_FAILURE_COUNT`,h=["ValidationException","ThrottlingException"];let w,y;const O="cb-toast-message-config",T="cb-trafficPercentage",v="disable_chat_ui";async function S(){try{await async function(){if(n().includes(v))return void console.log(`Chat UI disabled due to "${v}" experimental feature.`);const e=function(){const e=document.getElementById("mrc-sunrise-chat-loader")?.getAttribute("src");if(!e)return console.error("Missing required document element for chat script."),null;const t=e.split(".").slice(2,3).pop();return g.includes(t)?t:(console.error(`Unsupported stage value: ${t}`),null)}();if(!e)return;!function(e){const t="https",a="mrc-sunrise.marketing.aws.dev",n="us-east-1";w=`${t}://infra-api.${n}.${e}.${a}/custom-metric`,y=`${t}://chatbot-api.${n}.${e}.${a}/health-check`}(e);const t=window.location.hostname+window.location.pathname;if(!await async function(e){return!!localStorage||(await b(d,1,{logType:"INFO",messageObj:{hostname:e,message:"Browser HTML web storage, localStorage is null",userAgent:navigator.userAgent}}),!1)}(t))return;const{chatConfig:a,languageSupportedFeatures:u,theme:p,trafficPercentage:S,openonvisit:C,alwayson:F,headers:A,featureFlagMap:I,igniteSupportedFeatures:P,igniteTrafficPercentage:L,chatbotRoutingTreatment:M,toastMessageConfig:_,languageOverride:R}=await async function(){const e=window.location.hostname+window.location.pathname,t={hostname:e,languageCode:r()};let a,n;try{a=await fetch(y,{method:"POST",body:JSON.stringify(t)})}catch(t){return void await N(t,e)}try{n=await a.json();const r=n.error;if(r)return"The input fails to satisfy the constraints specified"===r.message&&await b(l,0,{logType:"ERROR",messageObj:{hostname:e,message:"Healthcheck returned invalid request exception",healthCheckParam:t,errorMessage:r.message}}),void h.includes(r.name);const{config:o,languageSupportedFeatures:s,theme:i,trafficPercentage:c,openonvisit:g,alwayson:u,headers:d,featureFlagMap:m,igniteSupportedFeatures:p,igniteTrafficPercentage:f,chatbotRoutingTreatment:w,toastMessageConfig:y,languageOverride:O}=n.data;if(!(o&&Object.keys(o).length&&s&&Object.keys(s).length))throw new Error(`Invalid Healthcheck response body: ${JSON.stringify(n)}`);return{chatConfig:o,languageSupportedFeatures:s,theme:i,trafficPercentage:c,openonvisit:g,alwayson:u,headers:d,featureFlagMap:m,igniteSupportedFeatures:p,igniteTrafficPercentage:f,chatbotRoutingTreatment:w,toastMessageConfig:y,languageOverride:O}}catch(a){return o(a)?void await N(a,e):s(a)?void await async function(e,t){return await b(f,1,{logType:"INFO",messageObj:{errorName:e.name,errorMessage:e.message,hostname:t,userAgent:navigator.userAgent}})}(a,e):void await b(l,0,{logType:"ERROR",messageObj:{hostname:e,message:"Error faced when parsing response",errorName:a.name,errorMessage:a.message,healthCheckRequest:JSON.stringify(t),healthCheckResponse:JSON.stringify(n)}})}}()||{};if(a&&u&&function(e,t=1){return 1===t||e<t}(function(){let e;const t=localStorage.getItem(T);if(t){const a=JSON.parse(t);e="number"!=typeof a?.expiryTimestamp||a.expiryTimestamp<Date.now()?E():parseFloat(a.generatedPercentage)}else e=E();return e}(),S)){(function(e){localStorage.setItem("cb-featureFlagMap",JSON.stringify(e))})(I),await async function(e,t){try{if(!e)return void localStorage.removeItem(O);const t=JSON.stringify(e);if(!t)throw new Error(`Invalid toast message config type: ${e}`);localStorage.setItem(O,t)}catch(e){await b(m,1,{logType:"ERROR",messageObj:{hostname:t,message:"Failed to store toast message configuration",errorName:e.name,errorMessage:e.message}})}}(_,t);try{!function({chatConfig:e,languageSupportedFeatures:t,theme:a,openonvisit:n,alwayson:r,headers:o,igniteSupportedFeatures:s,igniteTrafficPercentage:g,chatbotRoutingTreatment:u,languageOverride:l}){let d=document.getElementById("mrc-sunrise-chat");d||(d=document.createElement("div"),d.id="mrc-sunrise-chat",document.body.appendChild(d)),function({chatMountingPoint:e,languageSupportedFeatures:t,theme:a,openonvisit:n,alwayson:r,igniteSupportedFeatures:o,igniteTrafficPercentage:s,chatbotRoutingTreatment:g,languageOverride:u}){(function(e,t){let a;if(e.dataset.language)a=e.dataset.language;else{const n=window.location.pathname?.split("/")[1];a=Object.keys(t).indexOf(n)>-1?n:c.DEFAULT,e.dataset.language=a}e.dataset.locale||(e.dataset.locale=i[a]);const n=t[a]||{},r=Object.keys(n);for(let t=0;t<r.length;t++){const a=r[t],o=`${a}Enabled`;e.dataset[o]||(e.dataset[o]=n[a])}})(e,t),function(e,t){t&&!e.dataset.theme&&("webview-blue"===t?(e.dataset.theme="blue",e.dataset.webview="true",e.dataset.eventapp="true",e.dataset.alwayson="true"):e.dataset.theme=t)}(e,a),function(e,t){t&&(e.dataset.languageOverride=t)}(e,u),function(e,t){e.dataset.openonvisit=e.dataset.openonvisit||t?"true":"false"}(e,n),function(e,t){e.dataset.alwayson=e.dataset.alwayson||t?"true":"false"}(e,r),function(e,t,a){t&&(e.dataset.igniteSupportedFeatures=JSON.stringify(t)),void 0!==a&&(e.dataset.igniteTrafficPercentage=a)}(e,o,s),g&&(e.dataset.chatbotRoutingTreatment=g)}({chatMountingPoint:d,languageSupportedFeatures:t,theme:a,openonvisit:n,alwayson:r,igniteSupportedFeatures:s,igniteTrafficPercentage:g,chatbotRoutingTreatment:u,languageOverride:l}),localStorage.setItem("cb-config",JSON.stringify(e));const m=document.createElement("script");m.src=e.chatAppScriptPath,m.defer="defer",document.body.appendChild(m),function(e){const t=e?.cloudFrontCountry;localStorage.setItem("cb-headers",JSON.stringify({...t&&{cloudFrontCountry:t}}))}(o)}({chatConfig:a,languageSupportedFeatures:u,theme:p,openonvisit:C,alwayson:F,headers:A,igniteSupportedFeatures:P,igniteTrafficPercentage:L,chatbotRoutingTreatment:M,languageOverride:R})}catch(e){return void await b(d,1,{logType:"INFO",messageObj:{errorName:e.name,errorMessage:e.message,hostname:t,message:"Mount chat script failed",userAgent:navigator.userAgent}})}await b(l,1,{logType:"INFO",messageObj:{hostname:t,message:"Chat script loaded"}})}}()}catch(e){}}const b=async(e,t,a)=>{try{await fetch(w,{method:"POST",body:JSON.stringify({metrics:[{metric:{name:e,value:t,unit:"Count"},logMessage:a}],namespace:"ChatUi"})})}catch(e){}};function E(){const e=Math.random();return localStorage.setItem(T,JSON.stringify({generatedPercentage:e,expiryTimestamp:Date.now()+432e5})),e}async function N(e,t){return await b(p,1,{logType:"INFO",messageObj:{errorName:e.name,errorMessage:e.message,hostname:t,userAgent:navigator.userAgent}})}S(),"object"==typeof process&&(e.exports=S)}},t={};!function a(n){var r=t[n];if(void 0!==r)return r.exports;var o=t[n]={exports:{}};return e[n](o,o.exports,a),o.exports}(330)})();